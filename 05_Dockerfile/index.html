<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Dockerfile</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../01_Intro/index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../02_Installation/index.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../03_Images-Containers/index.html"><strong aria-hidden="true">3.</strong> Images Containers</a></li><li class="chapter-item expanded "><a href="../04_Parent-Images/index.html"><strong aria-hidden="true">4.</strong> Parent Images</a></li><li class="chapter-item expanded "><a href="../05_Dockerfile/index.html" class="active"><strong aria-hidden="true">5.</strong> Dockerfile</a></li><li class="chapter-item expanded "><a href="../06_Docker-Ignore/index.html"><strong aria-hidden="true">6.</strong> Docker Ignore</a></li><li class="chapter-item expanded "><a href="../07_Start-Stop-Containers/index.html"><strong aria-hidden="true">7.</strong> Start Stop Container</a></li><li class="chapter-item expanded "><a href="../08_Layer-Caching/index.html"><strong aria-hidden="true">8.</strong> Layer Caching</a></li><li class="chapter-item expanded "><a href="../09_Managing-Images_Containers/index.html"><strong aria-hidden="true">9.</strong> Managing Images Containers</a></li><li class="chapter-item expanded "><a href="../10_Volumes/index.html"><strong aria-hidden="true">10.</strong> Volumes</a></li><li class="chapter-item expanded "><a href="../11_Docker-Compose/index.html"><strong aria-hidden="true">11.</strong> Docker Compose</a></li><li class="chapter-item expanded "><a href="../12_Dockerizing-React-App/index.html"><strong aria-hidden="true">12.</strong> Dockerizing React App</a></li><li class="chapter-item expanded "><a href="../13_Dockerizing-ROS2/index.html"><strong aria-hidden="true">13.</strong> Dockerizing ROS2</a></li><li class="chapter-item expanded "><a href="../14_Sharing-Images-on-Hub/index.html"><strong aria-hidden="true">14.</strong> Sharing Images on Hub</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-dockerfile"><a class="header" href="#the-dockerfile">The Dockerfile</a></h1>
<p>In this tutorial, we'll delve into the essential component of Docker image creation – the Dockerfile. Dockerfiles serve as blueprints for building Docker images, defining the environment, dependencies, and configurations necessary for running your applications within containers. By the end of this crash course, you'll be equipped with the knowledge to create Dockerfiles and build Docker images effectively.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>In the previous lessons, we discussed how Docker images consist of multiple layers, with each layer representing changes or additions to the image. The initial layer typically comprises a parent image, such as an operating system or a specific software environment like Node.js or Python. Additional layers are then added to customize the image according to your application's requirements.</p>
<p>The Dockerfile is a text file that contains a set of instructions for Docker to build an image. These instructions define each layer of the image, specifying actions such as copying files, installing dependencies, and setting up the runtime environment.</p>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<p>Before we begin, ensure that Docker is installed on your system. You can download Docker Desktop for your operating system from the official Docker website.</p>
<h2 id="step-by-step-guide"><a class="header" href="#step-by-step-guide">Step-by-Step Guide</a></h2>
<h3 id="1-understanding-the-application"><a class="header" href="#1-understanding-the-application">1. Understanding the Application</a></h3>
<p>For demonstration purposes, we'll use a simple Node.js application. You can access the sample application's code in the <code>api</code> folder of the course files on GitHub (Lesson 5 branch).</p>
<h3 id="2-creating-the-dockerfile"><a class="header" href="#2-creating-the-dockerfile">2. Creating the Dockerfile</a></h3>
<ol>
<li>Open your text editor or integrated development environment (IDE).</li>
<li>Navigate to the root directory of your project.</li>
<li>Create a new file named <code>Dockerfile</code> (no file extension).</li>
</ol>
<h3 id="3-writing-the-dockerfile"><a class="header" href="#3-writing-the-dockerfile">3. Writing the Dockerfile</a></h3>
<p>Now, let's populate the Dockerfile with instructions to build our Docker image:</p>
<pre><code class="language-Dockerfile"># Specify the base image
FROM node:17-alpine

# Set the working directory inside the container
WORKDIR /app

# Copy application source code
COPY . .

# Install dependencies
RUN npm install

# Expose port 4000
EXPOSE 4000

# Command to run the application
CMD ["node", "app.js"]
</code></pre>
<p>Let's break down each instruction:</p>
<ul>
<li><code>FROM</code>: Specifies the base image (Node.js 17 on Alpine Linux).</li>
<li><code>WORKDIR</code>: Sets the working directory inside the container to <code>/app</code>.</li>
<li><code>COPY</code>: Copies the application source code from the host to the container's <code>/app</code> directory.</li>
<li><code>RUN</code>: Executes the <code>npm install</code> command to install dependencies.</li>
<li><code>EXPOSE</code>: Informs Docker that the application inside the container will listen on port 4000.</li>
<li><code>CMD</code>: Defines the command to run when the container starts (<code>node app.js</code>).</li>
</ul>
<h3 id="4-building-the-docker-image"><a class="header" href="#4-building-the-docker-image">4. Building the Docker Image</a></h3>
<ol>
<li>Open a terminal.</li>
<li>Navigate to the directory containing the Dockerfile.</li>
<li>Run the following command to build the Docker image:</li>
</ol>
<pre><code class="language-bash">docker build -t my-app .
</code></pre>
<ul>
<li><code>-t my-app</code>: Tags the image with the name <code>my-app</code>.</li>
<li><code>.</code>: Specifies the location of the Dockerfile (current directory).</li>
</ul>
<h3 id="5-running-the-docker-container"><a class="header" href="#5-running-the-docker-container">5. Running the Docker Container</a></h3>
<p>Once the image is built successfully, you can run a container using the following command:</p>
<pre><code class="language-bash">docker run -p 4000:4000 my-app
</code></pre>
<ul>
<li><code>-p 4000:4000</code>: Maps port 4000 of the host machine to port 4000 of the container.</li>
<li><code>my-app</code>: Specifies the name of the Docker image to use.</li>
</ul>
<p>Certainly! Let's create a comprehensive example to demonstrate the use of Docker and Dockerfiles. In this example, we'll build a Docker image for a Python web application using Flask framework.</p>
<h2 id="example-dockerizing-a-python-flask-application"><a class="header" href="#example-dockerizing-a-python-flask-application">Example: Dockerizing a Python Flask Application</a></h2>
<h3 id="1-project-structure"><a class="header" href="#1-project-structure">1. Project Structure</a></h3>
<p>Create a new directory for your project and organize the files as follows:</p>
<pre><code class="language-sh">project/
├── app/
│   ├── templates/
│   │   └── index.html
│   └── app.py
└── Dockerfile
</code></pre>
<h3 id="2-python-flask-application"><a class="header" href="#2-python-flask-application">2. Python Flask Application</a></h3>
<p>Create a simple Python Flask application that serves a basic web page:</p>
<h4 id="appapppy"><a class="header" href="#appapppy"><code>app/app.py</code></a></h4>
<pre><code class="language-python">from flask import Flask, render_template

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html')

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000)
</code></pre>
<h4 id="apptemplatesindexhtml"><a class="header" href="#apptemplatesindexhtml"><code>app/templates/index.html</code></a></h4>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Flask Docker Example&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Hello, Docker!&lt;/h1&gt;
    &lt;p&gt;This is a simple Flask web application running inside a Docker container.&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<h3 id="3-dockerfile"><a class="header" href="#3-dockerfile">3. Dockerfile</a></h3>
<p>Create a Dockerfile in the project directory to define the Docker image:</p>
<h4 id="dockerfile"><a class="header" href="#dockerfile"><code>Dockerfile</code></a></h4>
<pre><code class="language-Dockerfile"># Use the official Python image as a base
FROM python:3.9-slim

# Set environment variables
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

# Set the working directory inside the container
WORKDIR /app

# Copy the dependencies file to the working directory
COPY requirements.txt .

# Install dependencies
RUN pip install --no-cache-dir -r requirements.txt

# Copy the rest of the application code to the working directory
COPY . .

# Expose port 5000 to the outside world
EXPOSE 5000

# Command to run the application
CMD ["python", "app.py"]
</code></pre>
<h3 id="4-requirements-file"><a class="header" href="#4-requirements-file">4. Requirements File</a></h3>
<p>If your application has dependencies, create a <code>requirements.txt</code> file listing them:</p>
<h4 id="requirementstxt"><a class="header" href="#requirementstxt"><code>requirements.txt</code></a></h4>
<pre><code class="language-sh">Flask==2.0.1
</code></pre>
<h3 id="5-building-the-docker-image"><a class="header" href="#5-building-the-docker-image">5. Building the Docker Image</a></h3>
<p>Open a terminal, navigate to the project directory, and build the Docker image:</p>
<pre><code class="language-bash">docker build -t flask-docker-example .
</code></pre>
<h3 id="6-running-the-docker-container"><a class="header" href="#6-running-the-docker-container">6. Running the Docker Container</a></h3>
<p>Once the image is built successfully, run a container using the following command:</p>
<pre><code class="language-bash">docker run -p 5000:5000 flask-docker-example
</code></pre>
<h3 id="7-accessing-the-application"><a class="header" href="#7-accessing-the-application">7. Accessing the Application</a></h3>
<p>Open a web browser and navigate to <code>http://localhost:5000</code> to view the Flask application running inside the Docker container.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../04_Parent-Images/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../06_Docker-Ignore/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../04_Parent-Images/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../06_Docker-Ignore/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
